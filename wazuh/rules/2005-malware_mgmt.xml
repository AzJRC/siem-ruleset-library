<!--
# README

## Meta
Author: Alejandro Rodríguez
Rule-set Name: logon-audit
Rule-set ID: 200500
Rule-set Range: [200500, 200599] 

## Ruleset
Alerts for malware detection

## Requirements

### VirusTotal rules
To integrate VirusTotal, make sure you have fullfilled the following requirements:

1. The integration configuration for VirusTotal is added to Wazuh’s main configuration file (`/var/ossec/etc/ossec.conf`).
2. You have enabled active response features in the Wazuh´s main configuration file.
3. You have Developed and compiled active response scripts and saved them in `C:\Program Files (x86)\ossec-agent\active-response\bin (Assumming you used default installation)`.

For the requirement 3), you can refer to the repository's directory `wazuh/active_response` to get some prebulid scripts.

-->


<!-- Variables and constants -->
<var name="MS_USERS">^NT AUTHORITY$|</var>
<var name="STD_GROUP">windows</var>

<var name="custom_groups">malware-mgmt</var>


<!--Ruleset-->
<group name="virustotal">

    <!--
    Dependency rules 
    -->

    <!-- rule id="657" level="3">
        <if_sid>650</if_sid>
        <field name="command">add|delete</field>
        <description>Active response: $(parameters.program) - $(command)</description>
        <group>active_response,pci_dss_11.4,gdpr_IV_35.7.d,nist_800_53_SI.4,tsc_CC6.1,tsc_CC6.8,tsc_CC7.2,tsc_CC7.3,tsc_CC7.4,</group>
    </rule -->
  

    <!--
    Base matching rules
    -->


    <!--
    VirusTotal Integration
    -->

    <rule id="200500" level="12">
        <if_sid>657</if_sid>
        <match>Successfully removed threat</match>
        <description>$(parameters.program) removed threat located at $(parameters.alert.data.virustotal.source.file)</description>
    </rule>

    <rule id="200501" level="12">
        <if_sid>657</if_sid>
        <match>Error removing threat</match>
        <description>Error removing threat located at $(parameters.alert.data.virustotal.source.file)</description>
    </rule>

</group>